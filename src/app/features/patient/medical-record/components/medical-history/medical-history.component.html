<!-- <div class="medical-history-container space-y-6">

   
  <div class="flex flex-col md:flex-row justify-between items-start md:items-center p-6 bg-card rounded-2xl shadow-sm border border-border">
    <div class="mb-4 md:mb-0">
      <h2 class="text-2xl font-bold text-text flex items-center gap-3">
        <i class="fas fa-book-medical text-primary"></i>
        Medical History
      </h2>
      <p class="text-text-light">Patient medical records and health information</p>
    </div>
    <div class="flex space-x-3">
      <button (click)="refreshData()" class="btn-secondary flex items-center bg-card hover:bg-hover text-text-light font-medium py-2 px-4 rounded-lg border border-border shadow-sm transition-colors duration-150">
        <i class="fas fa-sync-alt mr-2"></i> Refresh
      </button>
    
    </div>
  </div>
 
  <div *ngIf="isLoading" class="flex items-center justify-center p-10 text-center bg-card rounded-card shadow-card">
    <div class="w-12 h-12 border-4 border-t-4 border-border border-t-primary rounded-full animate-spin mr-4"></div>
    <p class="text-text-light text-lg">Loading Medical History...</p>
  </div>

  <div *ngIf="!isLoading && errorMessage" class="bg-status-urgent/10 border border-status-urgent text-status-urgent px-4 py-3 rounded-card relative shadow-card" role="alert">
    <strong class="font-bold">Error!</strong>
    <span class="block sm:inline">{{ errorMessage }}</span>
  </div>
 
  <div *ngIf="!isLoading && !errorMessage" class="space-y-6">
   
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
      <div *ngFor="let card of summaryCards" 
           class="summary-card bg-card p-4 rounded-xl shadow-sm border border-border flex justify-between items-center"
           [class.border-red-400]="card.key === 'allergies' && card.count > 0"
           [class.bg-red-50]="card.key === 'allergies' && card.count > 0">
        <div>
          <p class="text-sm font-medium text-text-light" [class.text-red-600]="card.key === 'allergies' && card.count > 0">{{ card.title }}</p>
          <p class="text-3xl font-bold text-text">{{ card.count }}</p>
        </div>
        <div class="text-3xl opacity-60" [class]="card.colorClass">
          <i [class]="card.icon"></i>
        </div>
      </div>
    </div>
 
    <div class="bg-card p-2 rounded-xl shadow-sm border border-border flex flex-wrap gap-2">
      <button *ngFor="let filter of filters" 
              (click)="setFilter(filter.key)"
              class="px-4 py-2 text-sm font-medium rounded-lg transition-colors duration-150 focus:outline-none focus:ring-2 focus:ring-primary/50"
              [ngClass]="{
                'bg-primary text-white shadow': activeFilter === filter.key,
                'text-text-light hover:bg-hover hover:text-text': activeFilter !== filter.key
              }">
        {{ filter.label }}
      </button>
    </div>

   
    <div *ngIf="filteredRecords.length > 0; else noRecords" class="space-y-4">
      <div *ngFor="let record of filteredRecords" class="bg-card rounded-lg shadow-sm border border-border overflow-hidden">
        <div class="p-4 border-b border-border bg-hover">
          <p class="text-sm text-text-light">
            <i class="fas fa-calendar-alt mr-2"></i>Last Updated: <span class="font-medium text-text">{{ record.last_updated | date:'longDate' }}</span>
          </p>
        </div>
        <div *ngIf="hasData(record); else noDataInRecord" class="p-4 grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
          
          <div *ngIf="record.current_medical_conditions.length > 0">
            <h4 class="font-semibold text-text mb-2">Conditions</h4>
            <ul class="list-disc list-inside space-y-1">
              <li *ngFor="let item of record.current_medical_conditions" class="text-text-light">{{ item }}</li>
            </ul>
          </div>

          <div *ngIf="record.chronic_diseases.length > 0">
            <h4 class="font-semibold text-text mb-2">Chronic Diseases</h4>
            <ul class="list-disc list-inside space-y-1">
              <li *ngFor="let item of record.chronic_diseases" class="text-text-light">{{ item }}</li>
            </ul>
          </div>

          <div *ngIf="record.past_surgeries.length > 0">
            <h4 class="font-semibold text-text mb-2">Surgeries</h4>
            <ul class="list-disc list-inside space-y-1">
              <li *ngFor="let item of record.past_surgeries" class="text-text-light">{{ item }}</li>
            </ul>
          </div>

          <div *ngIf="record.current_medications.length > 0">
            <h4 class="font-semibold text-text mb-2">Medications</h4>
            <ul class="list-disc list-inside space-y-1">
              <li *ngFor="let item of record.current_medications" class="text-text-light">{{ item }}</li>
            </ul>
          </div>

          <div *ngIf="record.allergies.length > 0">
            <h4 class="font-semibold text-red-600 mb-2">Allergies</h4>
            <ul class="list-disc list-inside space-y-1">
              <li *ngFor="let item of record.allergies" class="text-red-500">{{ item }}</li>
            </ul>
          </div>

        </div>
        <ng-template #noDataInRecord>
          <p class="p-4 text-text-muted italic">This record contains no specific items.</p>
        </ng-template>
      </div>
    </div>

    <ng-template #noRecords>
      <div class="text-center py-16 bg-card rounded-lg shadow-sm border border-border">
        <i class="fas fa-file-medical-alt text-5xl text-text-muted mb-4"></i>
        <h3 class="text-xl font-semibold text-text">No Medical History Found</h3>
        <p class="text-text-light mt-1">No records match the current filter, or no -->

          

          
  <div class="medical-history-container space-y-6">
 
  <div class="flex flex-col md:flex-row justify-between items-start md:items-center p-6 bg-card rounded-2xl shadow-sm border border-border">
    <div class="mb-4 md:mb-0">
      <h2 class="text-2xl font-bold text-text flex items-center gap-3">
        <i class="fas fa-book-medical text-primary"></i>
        Medical History
      </h2>
      <p class="text-text-light">A consolidated summary of your medical records.</p>
    </div>
    <div class="flex space-x-3">
      <button (click)="refreshData()" class="btn-secondary flex items-center bg-card hover:bg-hover text-text-light font-medium py-2 px-4 rounded-lg border border-border shadow-sm transition-colors duration-150">
        <i class="fas fa-sync-alt mr-2"></i> Refresh
      </button>
    </div>
  </div>

  
  <div *ngIf="isLoading" class="flex items-center justify-center p-10 text-center bg-card rounded-card shadow-card">
    <div class="w-12 h-12 border-4 border-t-4 border-border border-t-primary rounded-full animate-spin mr-4"></div>
    <p class="text-text-light text-lg">Loading Medical History...</p>
  </div>

  <div *ngIf="!isLoading && errorMessage" class="bg-status-urgent/10 border border-status-urgent text-status-urgent px-4 py-3 rounded-card relative shadow-card" role="alert">
    <strong class="font-bold">Error!</strong>
    <span class="block sm:inline">{{ errorMessage }}</span>
  </div>

  
  <div *ngIf="!isLoading && !errorMessage" class="space-y-6">
     
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
      <div *ngFor="let card of summaryCards" 
           class="summary-card bg-card p-4 rounded-xl shadow-sm border border-border flex justify-between items-center"
           [class.border-red-400]="card.key === 'allergies' && card.count > 0"
           [class.bg-red-50]="card.key === 'allergies' && card.count > 0">
        <div>
          <p class="text-sm font-medium text-text-light" [class.text-red-600]="card.key === 'allergies' && card.count > 0">{{ card.title }}</p>
          <p class="text-3xl font-bold text-text">{{ card.count }}</p>
        </div>
        <div class="text-3xl opacity-60" [class]="card.colorClass">
          <i [class]="card.icon"></i>
        </div>
      </div>
    </div>

   
    <div *ngIf="hasAnyData(); else noRecords" class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      
     
      <div *ngIf="allAllergies.length > 0" class="bg-red-50 border border-red-200 rounded-lg shadow-sm p-5 lg:col-span-2">
        <h3 class="text-lg font-semibold text-red-700 flex items-center mb-3">
          <i class="fas fa-exclamation-triangle mr-3"></i>
          Allergies
        </h3>
        <ul class="list-disc list-inside space-y-1.5">
          <li *ngFor="let item of allAllergies" class="text-red-600">{{ item }}</li>
        </ul>
      </div>

      
      <div *ngIf="allConditions.length > 0" class="bg-card border border-border rounded-lg shadow-sm p-5">
        <h3 class="text-lg font-semibold text-text flex items-center mb-3">
          <i class="fas fa-procedures mr-3 text-blue-500"></i>
          Medical Conditions
        </h3>
        <ul class="list-disc list-inside space-y-1.5">
          <li *ngFor="let item of allConditions" class="text-text-light">{{ item }}</li>
        </ul>
      </div>

     
      <div *ngIf="allChronicDiseases.length > 0" class="bg-card border border-border rounded-lg shadow-sm p-5">
        <h3 class="text-lg font-semibold text-text flex items-center mb-3">
          <i class="fas fa-stopwatch-20 mr-3 text-purple-500"></i>
          Chronic Diseases
        </h3>
        <ul class="list-disc list-inside space-y-1.5">
          <li *ngFor="let item of allChronicDiseases" class="text-text-light">{{ item }}</li>
        </ul>
      </div>

       
      <div *ngIf="allPastSurgeries.length > 0" class="bg-card border border-border rounded-lg shadow-sm p-5">
        <h3 class="text-lg font-semibold text-text flex items-center mb-3">
          <i class="fas fa-cut mr-3 text-gray-600"></i>
          Past Surgeries
        </h3>
        <ul class="list-disc list-inside space-y-1.5">
          <li *ngFor="let item of allPastSurgeries" class="text-text-light">{{ item }}</li>
        </ul>
      </div>

       
      <div *ngIf="allCurrentMedications.length > 0" class="bg-card border border-border rounded-lg shadow-sm p-5">
        <h3 class="text-lg font-semibold text-text flex items-center mb-3">
          <i class="fas fa-pills mr-3 text-yellow-500"></i>
          Current Medications
        </h3>
        <ul class="list-disc list-inside space-y-1.5">
          <li *ngFor="let item of allCurrentMedications" class="text-text-light">{{ item }}</li>
        </ul>
      </div>

    </div>

    <ng-template #noRecords>
      <div class="text-center py-16 bg-card rounded-lg shadow-sm border border-border">
        <i class="fas fa-file-medical-alt text-5xl text-text-muted mb-4"></i>
        <h3 class="text-xl font-semibold text-text">No Medical History Found</h3>
        <p class="text-text-light mt-1">No medical history has been added yet.</p>
      </div>
    </ng-template>

  </div>
</div>