<div class="bg-card rounded-card shadow-card">
  <!-- Header -->
  <div class="p-4 border-b border-border">
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
      <div>
        <h2 class="text-section-header font-semibold text-text">Doctor Revenue Details</h2>
        <p class="text-xs text-text-muted mt-1">
          Detailed breakdown of revenue generated by doctors
        </p>
      </div>
      
      <!-- Search box -->
      <div class="relative w-full sm:w-auto">
        <input 
          type="text" 
          [(ngModel)]="searchTerm"
          (input)="onSearch()"
          placeholder="Search doctor..." 
          class="px-3 py-2 pl-9 rounded-button text-xs bg-background text-text border border-border w-full">
        
        <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-text-muted" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
        </div>
        
        <button 
          *ngIf="searchTerm" 
          (click)="clearSearch()" 
          class="absolute inset-y-0 right-0 flex items-center pr-3">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-text-muted hover:text-text" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
    </div>
  </div>
  
  <!-- Date Range Filters -->
  <div class="p-4 border-b border-border bg-background">
    <div class="flex flex-col sm:flex-row gap-4 items-end">
      <!-- Date inputs -->
      <div class="flex gap-2 items-end">
        <div>
          <label class="text-xs text-text-muted">From Date</label>
          <input 
            type="date" 
            [(ngModel)]="fromDate"
            class="block w-full px-2 py-1 text-xs border border-border rounded-input bg-card text-text">
        </div>
        <div>
          <label class="text-xs text-text-muted">To Date</label>
          <input 
            type="date" 
            [(ngModel)]="toDate"
            class="block w-full px-2 py-1 text-xs border border-border rounded-input bg-card text-text">
        </div>
        <button 
          (click)="applyDateFilter()"
          class="px-3 py-1 bg-primary text-white rounded-button text-xs hover:bg-primary-dark transition-colors">
          Apply
        </button>
      </div>
      
      <!-- Quick presets -->
      <div class="flex flex-wrap gap-1">
        <button *ngFor="let preset of datePresets"
          (click)="applyDatePreset(preset)"
          [class]="'px-2 py-1 rounded-button text-xs transition-colors ' + 
            (selectedDatePreset === preset.label ? 
            'bg-primary text-white' : 
            'bg-background text-text-muted hover:bg-hover')">
          {{ preset.label }}
        </button>
      </div>
    </div>
  </div>
  
  <!-- Content -->
  <div class="p-4">
    <!-- Loading state -->
    <div *ngIf="isLoading" class="py-12 flex justify-center items-center">
      <div class="animate-pulse text-text-muted">Loading doctor revenue data...</div>
    </div>
    
    <!-- Error state -->
    <div *ngIf="hasError" class="py-12 flex justify-center items-center">
      <div class="text-status-urgent text-center">
        <div class="mb-2">{{ errorMessage }}</div>
        <button 
          class="px-3 py-1 bg-background rounded-button text-text-muted hover:bg-hover text-xs"
          (click)="loadDoctorRevenueData()">
          Try Again
        </button>
      </div>
    </div>
    
    <!-- Table display -->
    <div *ngIf="!isLoading && !hasError" class="space-y-4">
      <!-- Data Table -->
      <div class="overflow-x-auto bg-background rounded-input">
        <table class="min-w-full divide-y divide-border">
          <thead>
            <tr class="bg-background text-left text-xs font-medium text-text-muted uppercase tracking-wider">
              <th class="px-6 py-3 cursor-pointer" (click)="changeSort('doctor_name')">
                <div class="flex items-center">
                  Doctor Name
                  <span *ngIf="sortBy === 'doctor_name'" class="ml-1">
                    {{ sortDirection === 'asc' ? '↑' : '↓' }}
                  </span>
                </div>
              </th>
              <th class="px-6 py-3 cursor-pointer" (click)="changeSort('total_revenue')">
                <div class="flex items-center">
                  Total Revenue
                  <span *ngIf="sortBy === 'total_revenue'" class="ml-1">
                    {{ sortDirection === 'asc' ? '↑' : '↓' }}
                  </span>
                </div>
              </th>
              <th class="px-6 py-3 cursor-pointer" (click)="changeSort('bill_count')">
                <div class="flex items-center">
                  Bills
                  <span *ngIf="sortBy === 'bill_count'" class="ml-1">
                    {{ sortDirection === 'asc' ? '↑' : '↓' }}
                  </span>
                </div>
              </th>
              <th class="px-6 py-3 cursor-pointer" (click)="changeSort('average_bill_amount')">
                <div class="flex items-center">
                  Avg. Bill
                  <span *ngIf="sortBy === 'average_bill_amount'" class="ml-1">
                    {{ sortDirection === 'asc' ? '↑' : '↓' }}
                  </span>
                </div>
              </th>
            </tr>
          </thead>
          <tbody class="bg-card divide-y divide-border">
            <tr *ngFor="let doctor of displayedDoctorData" class="hover:bg-hover transition-colors">
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-text">{{ doctor.doctor_name }}</div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm font-medium text-text">{{ formatCurrency(doctor.total_revenue) }}</div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-text">
                {{ doctor.bill_count }}
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-text">{{ formatCurrency(doctor.average_bill_amount) }}</div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <!-- Empty state within table -->
      <div *ngIf="filteredDoctorData.length === 0" class="py-8 text-center text-text-muted">
        No doctor revenue data found. Try adjusting your search or date filters.
      </div>
      
      <!-- Pagination -->
      <div *ngIf="filteredDoctorData.length > 0" class="flex justify-between items-center pt-4">
        <div class="text-xs text-text-muted">
          Showing {{ displayedDoctorData.length }} of {{ filteredDoctorData.length }} doctors
        </div>
        
        <div class="flex space-x-1">
          <!-- Previous page button -->
          <button 
            (click)="prevPage()" 
            [disabled]="currentPage === 1"
            [class]="'px-2 py-1 rounded-button text-xs transition-colors ' + 
              (currentPage === 1 ? 'bg-background text-text-muted opacity-50 cursor-not-allowed' : 
              'bg-background text-text-muted hover:bg-hover')">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
            </svg>
          </button>
          
          <!-- Page numbers -->
          <button *ngFor="let pageNum of pageNumbers"
            (click)="goToPage(pageNum)"
            [class]="'px-2 py-1 rounded-button text-xs transition-colors ' + 
              (currentPage === pageNum ? 'bg-primary text-white' : 
              'bg-background text-text-muted hover:bg-hover')">
            {{ pageNum }}
          </button>
          
          <!-- Next page button -->
          <button 
            (click)="nextPage()" 
            [disabled]="currentPage === totalPages"
            [class]="'px-2 py-1 rounded-button text-xs transition-colors ' + 
              (currentPage === totalPages ? 'bg-background text-text-muted opacity-50 cursor-not-allowed' : 
              'bg-background text-text-muted hover:bg-hover')">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
